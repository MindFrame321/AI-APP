<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focufy</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <svg width="48" height="48" viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="64" cy="64" r="60" fill="url(#popupHeaderGradient)"/>
          <circle cx="64" cy="64" r="45" stroke="white" stroke-width="3" fill="none" opacity="0.3"/>
          <circle cx="64" cy="64" r="30" stroke="white" stroke-width="3" fill="none" opacity="0.5"/>
          <circle cx="64" cy="64" r="20" fill="white"/>
          <text x="64" y="72" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#667eea" text-anchor="middle" dominant-baseline="middle">F</text>
          <defs>
            <linearGradient id="popupHeaderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ffffff;stop-opacity:0.25" />
              <stop offset="100%" style="stop-color:#ffffff;stop-opacity:0.15" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1>Focufy</h1>
      <p class="subtitle">Stay focused, block distractions</p>
    </header>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen hidden">
      <div class="login-content">
        <div class="login-icon">
          <svg width="48" height="48" viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="64" cy="64" r="60" fill="url(#gradient)"/>
            <circle cx="64" cy="64" r="45" stroke="white" stroke-width="3" fill="none" opacity="0.3"/>
            <circle cx="64" cy="64" r="30" stroke="white" stroke-width="3" fill="none" opacity="0.5"/>
            <circle cx="64" cy="64" r="20" fill="white"/>
            <text x="64" y="72" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#667eea" text-anchor="middle" dominant-baseline="middle">F</text>
            <defs>
              <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <h2>Welcome to Focufy</h2>
        <p class="login-subtitle">Sign in to sync your focus sessions across devices</p>
        
        <div class="oauth-client-id-section">
          <label for="oauthClientId" class="oauth-label">
            <span>ğŸ”‘ OAuth Client ID (Optional)</span>
            <span class="oauth-hint">Enter your Google OAuth Client ID to use your own credentials</span>
          </label>
          <input 
            type="text" 
            id="oauthClientId" 
            class="oauth-input" 
            placeholder="e.g., 42484888880-xxxxx.apps.googleusercontent.com"
            autocomplete="off"
          >
          <p class="oauth-help">Leave empty to use default. Each user can use their own Client ID.</p>
        </div>
        
        <div class="auth-buttons">
          <button id="googleSignInBtn" class="btn btn-google" type="button">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
              <path d="M9 18c2.43 0 4.467-.806 5.96-2.184l-2.908-2.258c-.806.54-1.837.86-3.052.86-2.347 0-4.33-1.585-5.04-3.715H.957v2.332C2.438 15.983 5.482 18 9 18z" fill="#34A853"/>
              <path d="M3.96 10.703c-.18-.54-.282-1.117-.282-1.703s.102-1.163.282-1.703V4.965H.957C.348 6.175 0 7.55 0 9s.348 2.825.957 4.035l3.003-2.332z" fill="#FBBC05"/>
              <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.965L3.96 7.297C4.67 5.167 6.653 3.58 9 3.58z" fill="#EA4335"/>
            </svg>
            <span>Continue with Google</span>
          </button>
          
          <button id="githubSignInBtn" class="btn btn-github" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            <span>Continue with GitHub</span>
          </button>
          
          <button id="emailSignInBtn" class="btn btn-email" type="button">
            <span>ğŸ“§</span>
            <span>Continue with Email</span>
          </button>
        </div>
        
        <p class="login-footer">By continuing, you agree to our Terms of Service</p>
      </div>
    </div>

    <!-- User Profile (when logged in) -->
    <div id="userProfile" class="user-profile hidden">
      <div class="profile-header">
        <img id="userAvatar" src="" alt="User" class="user-avatar">
        <div class="profile-info">
          <div class="user-name" id="userName">Loading...</div>
          <div class="user-email" id="userEmail">Loading...</div>
          <div class="user-stats">
            <div class="stat-item">
              <span class="stat-icon">ğŸ”¥</span>
              <span class="stat-value" id="streakValue">0</span>
              <span class="stat-label">day streak</span>
            </div>
            <div class="stat-item">
              <span class="stat-icon">â­</span>
              <span class="stat-value" id="pointsValue">0</span>
              <span class="stat-label">points</span>
            </div>
            <div class="stat-item">
              <span class="stat-icon">ğŸ†</span>
              <span class="stat-value" id="levelValue">1</span>
              <span class="stat-label">level</span>
            </div>
          </div>
        </div>
        <button id="logoutBtn" class="btn-logout" title="Sign out">âœ•</button>
      </div>
    </div>

    <!-- Gamification Panel -->
    <div id="gamificationPanel" class="gamification-panel hidden">
      <div class="panel-header">
        <h3>ğŸ® Your Progress</h3>
        <button class="btn-close" onclick="hideGamification()">âœ•</button>
      </div>
      
      <div class="level-section">
        <div class="level-display">
          <div class="level-badge" id="levelBadge">Level 1</div>
          <div class="level-name" id="levelName">Beginner</div>
          <div class="level-progress">
            <div class="progress-bar">
              <div class="progress-fill" id="levelProgress"></div>
            </div>
            <div class="progress-text">
              <span id="currentPoints">0</span> / <span id="nextLevelPoints">100</span> points
            </div>
          </div>
        </div>
      </div>

      <div class="daily-challenge-section">
        <h4>ğŸ“… Daily Challenge</h4>
        <div id="dailyChallenge" class="challenge-card">
          <div class="challenge-icon">ğŸ¯</div>
          <div class="challenge-content">
            <div class="challenge-name" id="challengeName">Loading...</div>
            <div class="challenge-description" id="challengeDesc"></div>
            <div class="challenge-progress">
              <div class="progress-bar">
                <div class="progress-fill" id="challengeProgress"></div>
              </div>
              <div class="progress-text" id="challengeProgressText">0 / 0</div>
            </div>
          </div>
        </div>
      </div>

      <div class="achievements-section">
        <h4>ğŸ† Achievements</h4>
        <div id="achievementsGrid" class="achievements-grid"></div>
      </div>

      <div class="recent-achievements">
        <h4>âœ¨ Recent Unlocks</h4>
        <div id="recentAchievements" class="recent-list"></div>
      </div>
    </div>

    <div id="sessionActive" class="session-active hidden">
      <div class="session-info">
        <div class="status-badge">
          <span class="status-dot"></span>
          <span>Active Session</span>
        </div>
        <div class="task-card">
          <div class="task-label">Your Focus Goal</div>
          <div class="task-text" id="activeTask"></div>
        </div>
        <div class="timer-card">
          <div class="timer-icon">â±ï¸</div>
          <div class="timer-content">
            <div class="timer-label">Time Remaining</div>
            <div class="timer-value" id="remainingTime">--:--</div>
          </div>
        </div>
        <button id="endSessionBtn" class="btn btn-secondary">End Session</button>
        <p class="info-text">Only content related to your goal is shown</p>
      </div>
    </div>

    <!-- Password Modal for Ending Session -->
    <div id="passwordModal" class="modal hidden">
      <div class="modal-content">
        <h3>ğŸ”’ End Focus Session</h3>
        <p class="modal-subtitle">Enter your password to end this session</p>
        <input type="password" id="endSessionPassword" class="modal-input" placeholder="Enter password" autocomplete="off">
        <div class="modal-buttons">
          <button id="confirmEndBtn" class="btn btn-primary">End Session</button>
          <button id="cancelEndBtn" class="btn btn-secondary">Cancel</button>
        </div>
        <div id="passwordError" class="error-message hidden"></div>
      </div>
    </div>

    <!-- Password Setup Modal -->
    <div id="setupPasswordModal" class="modal hidden">
      <div class="modal-content">
        <h3>ğŸ” Set Session Password</h3>
        <p class="modal-subtitle">Protect your focus sessions with a password</p>
        <input type="password" id="newPassword" class="modal-input" placeholder="Enter new password" autocomplete="off">
        <input type="password" id="confirmPassword" class="modal-input" placeholder="Confirm password" autocomplete="off">
        <div class="modal-buttons">
          <button id="savePasswordBtn" class="btn btn-primary">Save Password</button>
          <button id="skipPasswordBtn" class="btn btn-secondary">Skip</button>
        </div>
        <div id="passwordSetupError" class="error-message hidden"></div>
      </div>
    </div>
      </div>
    </div>

    <div id="sessionInactive" class="session-controls">
      <div class="form-section">
        <div class="form-group">
          <label for="taskInput">
            <span class="label-icon">ğŸ“š</span>
            What's your study goal?
          </label>
          <textarea 
            id="taskInput" 
            placeholder="e.g., Learn linear algebra, Study biology, Practice Python programming..."
            rows="3"
          ></textarea>
          <p class="input-hint">Be specific! This helps AI show only relevant content.</p>
          <div class="input-group">
            <button id="decomposeBtn" class="btn btn-secondary" type="button">Break into subgoals</button>
          </div>
          <div id="subgoalContainer" class="subgoal-container hidden">
            <div class="subgoal-title">Checklist</div>
            <ul id="subgoalList" class="subgoal-list"></ul>
          </div>
        </div>

        <div class="form-group">
          <label for="durationSelect">
            <span class="label-icon">â°</span>
            Focus Duration
          </label>
          <select id="durationSelect">
            <option value="25">25 minutes (Pomodoro)</option>
            <option value="45">45 minutes</option>
            <option value="60">60 minutes</option>
            <option value="90">90 minutes</option>
            <option value="custom">Custom</option>
          </select>
        </div>

        <div class="form-group hidden" id="customDurationGroup">
          <label for="customDuration">Custom Duration (minutes)</label>
          <input 
            type="number" 
            id="customDuration" 
            min="1" 
            max="480" 
            value="30"
          >
        </div>

        <div class="form-group">
          <label for="energySelect">
            <span class="label-icon">âš¡</span>
            Energy Level
          </label>
          <select id="energySelect">
            <option value="">Select...</option>
            <option value="High">High</option>
            <option value="Low">Low</option>
            <option value="Exhausted">Exhausted</option>
          </select>
        </div>

        <div class="form-group">
          <label for="contractInput">
            <span class="label-icon">âœï¸</span>
            Personal Contract (optional)
          </label>
          <textarea 
            id="contractInput" 
            placeholder="I commit to..."
            rows="2"
          ></textarea>
          <p class="input-hint">Private promise you track yourself.</p>
        </div>
      </div>

      <button id="startSessionBtn" class="btn btn-primary">
        <span>Start Focus Session</span>
        <span class="btn-arrow">â†’</span>
      </button>
      
      <div class="footer-links">
        <a href="#" id="settingsLink">
          <span>âš™ï¸</span> Settings
        </a>
        <a href="#" id="analyticsLink">
          <span>ğŸ“Š</span> Analytics
        </a>
        <a href="#" id="helpLink">
          <span>â“</span> Help
        </a>
      </div>
    </div>

    <div id="statusMessage" class="status-message hidden"></div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
